from __future__ import division
import numpy as np
import matplotlib.pyplot as plt
# coding=utf-8


from Turbina import Turbina
from scipy import interpolate

class Turbina_BlindTest_3_TSR4_75(Turbina):

    def __init__(self, coord):
        d_0 = 0.894
        super(Turbina_BlindTest_3_TSR4_75, self).__init__(d_0, coord)

    def c_T_tabulado(self, U):

        # entiendo que hay un problema con el U_tabulado por lo que me
        # tira 'ValueError:     Error on input data', no logro ver donde esta
        # el problema, por lo tanto uso las curvas de BT2

        # testeando: el problema esta en U_tabulado
        # U_tabulado = np.arange(18)
        # U_tabulado = np.array([4.14787101851, 4.41588232547, 4.72385445179, 5.07072755312, 5.47714654995, 5.96259428096, 6.54767246471, 7.37306397838, 8.32410129961, 8.17335446707, 9.42431992541, 10.6723205508, 11.7526468642, 13.3315498462, 14.9937539227, 19.3829819477, 29.5426091135, 60.8239511797])
        # c_T_tabulado = np.array([0.849723747241, 0.861351501437, 0.867629193779, 0.864500584885, 0.854468979411, 0.835866760934, 0.808834619317, 0.764095347829, 0.716490293811, 0.719544389506, 0.63973365993, 0.607824759891, 0.569526088252, 0.463827607969, 0.343459877356, 0.269069949519, 0.191626415384, 0.125200685221])

        U_tabulado = np.array([3.56135115899, 3.56547783208 , 3.66054806312 , 3.69998206373 , 4.00854765204 , 4.09521993031 , 4.4241382668 , 4.55770878947 , 4.98071967506 , 5.08498044583 , 5.32944909023 , 5.42535198145 , 5.69228752348 , 5.80755443632 , 6.13763130303 , 6.23859775363 , 6.60572156018 , 6.77061317059 , 6.77543074148 , 7.23796532963 , 7.33258499463 , 8.06752026333 , 8.15174412018 , 8.88833511837 , 8.8956552691 , 8.93562677517 , 9.90256792528 , 10.0925054085 , 13.0052054885 , 13.6327952832 , 18.6553937623 , 25.4092060249 , 26.1534663976 , 26.1969867627 , 26.2179894845 , 26.3258260425 , 43.5172340061 , 43.7376865951])
        c_T_tabulado = np.array([1.1165769166, 1.10234113227, 1.104641417, 1.09209267192, 1.07543862479, 1.06868057083, 1.06862544338, 1.04330601836, 1.02273510393, 1.00467465793, 0.990941599229, 0.973980338424, 0.958124139533, 0.941486356226, 0.919590797054, 0.905870026831, 0.882708383358, 0.861592864254, 0.863359370066, 0.824484594668, 0.815656436082, 0.771978992581, 0.764469311128, 0.741513143654, 0.737218903195, 0.737422358271, 0.668222782961, 0.651538568644, 0.397861884221, 0.381706732783, 0.300882883854, 0.239947674624, 0.237579050069, 0.232946082889, 0.236635820069, 0.235402739615, 0.181321292469, 0.181321292469])

        tck = interpolate.splrep(U_tabulado, c_T_tabulado, s=0)
        c_Tnew = interpolate.splev(U, tck, der=0)
        return c_Tnew

    def P_tabulado(self, U):
        Pnew = 0 ###??????
        return Pnew
